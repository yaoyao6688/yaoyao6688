<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Bypass the HTML file suffix restriction when uploading files | beautiful test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="0x01I installed the latest version of monstra CMS and found upload bypass in the systemIn the latest version(3.0.4), the system forbids HTML suffix name upload, but now it can bypass it.   0x02Vulnera">
<meta property="og:type" content="article">
<meta property="og:title" content="Bypass the HTML file suffix restriction when uploading files">
<meta property="og:url" content="http://yoursite.com/2019/10/12/Bypass-the-HTML-file-suffix-restriction-when-uploading-files/index.html">
<meta property="og:site_name" content="beautiful test">
<meta property="og:description" content="0x01I installed the latest version of monstra CMS and found upload bypass in the systemIn the latest version(3.0.4), the system forbids HTML suffix name upload, but now it can bypass it.   0x02Vulnera">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://i.loli.net/2019/10/12/8PwIjNJXZu1TULV.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/FenPgaHhEcuR7xI.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/IKx9s3GArfTSLZa.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/gK1hOqvHtEIAJNL.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/tgcb9dJELnNDrx8.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/9oY3Vsy1IwCehjf.png">
<meta property="og:updated_time" content="2019-10-13T02:54:03.407Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bypass the HTML file suffix restriction when uploading files">
<meta name="twitter:description" content="0x01I installed the latest version of monstra CMS and found upload bypass in the systemIn the latest version(3.0.4), the system forbids HTML suffix name upload, but now it can bypass it.   0x02Vulnera">
<meta name="twitter:image" content="https://i.loli.net/2019/10/12/8PwIjNJXZu1TULV.png">
  
    <link rel="alternate" href="/atom.xml" title="beautiful test" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">beautiful test</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Bypass-the-HTML-file-suffix-restriction-when-uploading-files" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/12/Bypass-the-HTML-file-suffix-restriction-when-uploading-files/" class="article-date">
  <time datetime="2019-10-12T12:55:33.000Z" itemprop="datePublished">2019-10-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Bypass the HTML file suffix restriction when uploading files
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>0x01</strong><br>I installed the latest version of monstra CMS and found upload bypass in the system<br><strong>In the latest version(3.0.4), the system forbids HTML suffix name upload, but now it can bypass it.</strong></p>
<p><img src="https://i.loli.net/2019/10/12/8PwIjNJXZu1TULV.png" alt="图片.png"></p>
<p><img src="https://i.loli.net/2019/10/12/FenPgaHhEcuR7xI.png" alt="图片.png"></p>
<p><strong>0x02</strong><br><strong>Vulnerability proof</strong></p>
<p>You can bypass the file upload limit by putting double quotes before the suffix of HTML </p>
<p>1  Visit website http://[address]:[port]/[app_path]/admin/index.php?id=filesmanager with login</p>
<p>2  Save html codes with ‘.png’extensions. and upload it like below.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;html&gt; </span><br><span class="line">    &lt;head&gt; </span><br><span class="line">	    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">        &lt;title&gt;hacker&lt;/title&gt; </span><br><span class="line">    &lt;/head&gt; </span><br><span class="line">    &lt;body&gt; </span><br><span class="line">     &lt;svg/onload=alert(document.cookie)&gt;</span><br><span class="line">    &lt;/body&gt; </span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/12/IKx9s3GArfTSLZa.png" alt="图片.png"></p>
<p>Click the uploaded file and Grab the packet and change the suffix name to XXX””.html at filename，This circumvents this limitation.</p>
<p><img src="https://i.loli.net/2019/10/12/gK1hOqvHtEIAJNL.png" alt="图片.png"></p>
<p><img src="https://i.loli.net/2019/10/12/tgcb9dJELnNDrx8.png" alt="图片.png"></p>
<p>4 move to http://[address]:[port]/[app_path]/public/uploads/[uploaded file]</p>
<p> You can see that you executed HTML and JS code，If you access this file,  you can get the administrator’s cookie and execute any JS code</p>
<p><img src="https://i.loli.net/2019/10/12/9oY3Vsy1IwCehjf.png" alt="图片.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/12/Bypass-the-HTML-file-suffix-restriction-when-uploading-files/" data-id="ck6djoh080000vnjhq4nsaoos" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2019/10/12/Bypass-the-HTML-file-suffix-restriction-when-uploading-files/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/10/13/SQL-injection-in-Gila-CMS-version-1-11-4/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          SQL injection in Gila CMS version 1.11.4
        
      </div>
    </a>
  
  
    <a href="/2019/09/22/正则表达式总结和引起的思考/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">正则表达式总结和引起的思考</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/08/NDK-Build-方式实现JIN/">NDK-Build 方式实现JIN</a>
          </li>
        
          <li>
            <a href="/2020/01/29/hadoop-伪分布式/">hadoop 伪分布式</a>
          </li>
        
          <li>
            <a href="/2020/01/12/深入剖析代审的线程安全问题/">深入剖析代审的线程安全问题</a>
          </li>
        
          <li>
            <a href="/2020/01/05/关于最近的log4j的漏洞复现及分析/">关于最近log4j的漏洞复现及分析</a>
          </li>
        
          <li>
            <a href="/2020/01/04/关于安卓SSL单项校验和双向校验的思考和总结/">关于安卓SSL单项校验和双向校验的思考和总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 test<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'your_disqus_shortname';
  
  var disqus_url = 'http://yoursite.com/2019/10/12/Bypass-the-HTML-file-suffix-restriction-when-uploading-files/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>